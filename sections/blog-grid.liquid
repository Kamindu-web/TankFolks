{% comment %}
  Blog Grid Section
  - Displays latest posts from a chosen blog
  - Responsive grid, shadowed cards, PT Sans typography
  - Adjustable post count
{% endcomment %}

<section class="blog-grid" data-section-id="{{ section.id }}">
    <style>
      #bg-wrap-{{ section.id }} {
        max-width: {{ section.settings.max_width }}px;
        margin: 0 auto;
        padding: 40px 16px;
        box-sizing: border-box;
      }
      #bg-wrap-{{ section.id }} h2 {
        font: 700 28px/1.2 "PT Sans", system-ui, Arial;
        margin: 0 0 28px;
      }
  
      .bg-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 24px;
      }
      .bg-card {
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 2px 10px rgba(0,0,0,.08);
        overflow: hidden;
        display: flex;
        flex-direction: column;
        transition: transform .18s ease, box-shadow .18s ease;
      }
      .bg-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 10px 22px rgba(0,0,0,.12);
      }
      .bg-img {
        width: 100%;
        padding-top: 56%;
        position: relative;
        background: #fafafa;
      }
      .bg-img img {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .bg-body {
        padding: 14px 16px 18px;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .bg-meta {
        font-size: 13px;
        color: #777;
        display: flex;
        justify-content: space-between;
      }
      .bg-title {
        font: 600 17px/1.4 "PT Sans", system-ui, Arial;
        color: #111;
        text-decoration: none;
      }
      .bg-excerpt {
        font: 14px/1.5 "PT Sans", system-ui, Arial;
        color: #444;
      }
    </style>
  
    <div id="bg-wrap-{{ section.id }}">
      {% if section.settings.heading != blank %}
        <h2>{{ section.settings.heading }}</h2>
      {% endif %}
  
      {% assign blog = blogs[section.settings.blog] %}
      {% if blog and blog.articles_count > 0 %}
        <div class="bg-grid">
          {% for article in blog.articles limit: section.settings.limit %}
            <div class="bg-card">
              <a class="bg-img" href="{{ article.url }}">
                {% if article.image %}
                  <img src="{{ article.image | image_url: width: 600 }}" alt="{{ article.title | escape }}">
                {% endif %}
              </a>
              <div class="bg-body">
                <div class="bg-meta">
                  <span>{{ article.tags | join: ", " | truncate: 20 }}</span>
                  <span>{{ article.published_at | date: "%b %e, %Y" }}</span>
                </div>
                <a class="bg-title" href="{{ article.url }}">{{ article.title }}</a>
                {% if section.settings.show_excerpt %}
                  <p class="bg-excerpt">{{ article.excerpt | strip_html | truncate: 100 }}</p>
                {% endif %}
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <p>No articles found. Choose a blog with posts.</p>
      {% endif %}
    </div>
  </section>
  
  {% schema %}
  {
    "name": "Blog Grid",
    "enabled_on": { "templates": ["*"] },
    "settings": [
      { "type": "text", "id": "heading", "label": "Section heading", "default": "What's happening now" },
      { "type": "range", "id": "max_width", "min": 800, "max": 1600, "step": 20, "label": "Content max width (px)", "default": 1200 },
      { "type": "blog", "id": "blog", "label": "Choose blog" },
      { "type": "range", "id": "limit", "min": 2, "max": 12, "step": 1, "label": "Posts to show", "default": 4 },
      { "type": "checkbox", "id": "show_excerpt", "label": "Show excerpt", "default": true }
    ],
    "presets": [
      { "name": "Blog Grid", "category": "Blog" }
    ]
  }
  {% endschema %}
  